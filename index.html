<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#1a237e">
    <meta name="description" content="현대아이티 스마트보드 렌탈 견적">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="HDIT렌탈">
    <link rel="manifest" href="manifest.json">
    <link rel="icon" type="image/png" href="images/logo.png">
    <link rel="apple-touch-icon" href="images/logo.png">
    <title>현대아이티 스마트보드 렌탈</title>
    <link rel="preconnect" href="https://cdn.jsdelivr.net">
    <link href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/variable/pretendardvariable-dynamic-subset.min.css" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="footer-data.js"></script>
</head>
<body>
    <!-- 헤더 -->
    <header class="header">
        <div class="header-top">
            <div class="logo-area">
                <img src="images/logo.png" alt="현대아이티">
                <h1>스마트보드 렌탈</h1>
            </div>
            <button class="install-btn" id="installBtn" onclick="installApp()">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M12 5v14M5 12l7 7 7-7"/></svg>
                설치
            </button>
        </div>
        <nav class="tab-nav">
            <button class="tab-btn active" onclick="switchTab('quote')">렌탈 견적</button>
            <button class="tab-btn" onclick="switchTab('estimate')">견적서 출력</button>
            <button class="tab-btn" onclick="switchTab('strength')">현대아이티 강점</button>
        </nav>
    </header>

    <main class="main">
        <!-- 렌탈 견적 탭 -->
        <div id="tab-quote" class="tab-content active">
            <!-- 렌탈 유형 선택 -->
            <div class="select-group">
                <h2><span class="icon">1</span> 렌탈 유형</h2>
                <div class="rental-type-badges" id="rentalTypeBadges">
                    <button class="rental-type-badge active" data-type="선납렌탈" onclick="selectRentalType('선납렌탈')">
                        <span class="badge-title">선납렌탈</span>
                        <span class="badge-desc">선납금 납부 후 낮은 월 렌탈료</span>
                    </button>
                    <button class="rental-type-badge" data-type="일반렌탈" onclick="selectRentalType('일반렌탈')">
                        <span class="badge-title">일반렌탈</span>
                        <span class="badge-desc">선납금 없이 월 렌탈료만 납부</span>
                    </button>
                </div>
            </div>

            <!-- 제품 선택 -->
            <div class="select-group">
                <h2><span class="icon">2</span> 제품 선택</h2>
                <div class="category-badges" id="categoryBadges">
                    <button class="category-badge" data-cat="MX" onclick="selectCategory('MX')">
                        <span class="badge-label">인기</span>
                        MX (기업형)
                    </button>
                    <button class="category-badge" data-cat="IX" onclick="selectCategory('IX')">
                        <span class="badge-label">최신</span>
                        IX (프리미엄)
                    </button>
                    <button class="category-badge" data-cat="저가형" onclick="selectCategory('저가형')">저가형</button>
                </div>

                <div class="form-field">
                    <label>화면 크기</label>
                    <select id="selSize" onchange="onSizeChange()" disabled>
                        <option value="">제품을 먼저 선택하세요</option>
                    </select>
                </div>

                <div class="form-field">
                    <label>설치 타입</label>
                    <select id="selType" onchange="onTypeChange()" disabled>
                        <option value="">화면 크기를 먼저 선택하세요</option>
                    </select>
                </div>

                <div class="form-field" id="depositField" style="display:none">
                    <label>선납금</label>
                    <select id="selDeposit" onchange="onDepositChange()" disabled>
                        <option value="">선납금 선택</option>
                    </select>
                </div>
            </div>

            <!-- 제품 스펙 정보 -->
            <div class="spec-section" id="specSection" style="display:none">
                <h3>제품 사양</h3>
                <div class="spec-grid" id="specGrid"></div>
                <div class="gift-box" id="giftBox" style="display:none">
                    <span class="gift-label">사은품</span>
                    <span class="gift-items" id="giftItems"></span>
                </div>
            </div>

            <!-- 결과 영역 -->
            <div class="result-section" id="resultSection">
                <div class="result-header" id="resultHeader"></div>
                <div class="price-grid" id="priceGrid"></div>
                <div class="notice-box">
                    <p>* 상기 금액은 부가세, 설치비, 스탠드비용이 포함된 금액입니다.</p>
                    <p>* E/V가 없거나 제주도 및 지역에 따라 운송비, 설치비가 부과될 수 있습니다.</p>
                    <p id="noticeDeposit">* 선납 렌탈 상품으로, 선납금은 계약 시 납부합니다.</p>
                    <p>* 렌탈 기간 종료 후 제품 소유권이 이전됩니다.</p>
                </div>
            </div>

            <!-- 빈 상태 -->
            <div class="empty-state" id="emptyState">
                <div class="icon">&#128187;</div>
                <p>제품과 규격을 선택하시면<br>렌탈 견적을 확인하실 수 있습니다.</p>
            </div>
        </div>

        <!-- 견적서 출력 탭 -->
        <div id="tab-estimate" class="tab-content">
            <div class="select-group">
                <h2><span class="icon">P</span> 견적서 출력</h2>
                <div id="estNoProduct" class="empty-state" style="padding:20px;">
                    <div class="icon">&#128196;</div>
                    <p>렌탈 견적 탭에서 제품을 먼저 선택한 후<br>이 탭에서 견적서를 생성하세요.</p>
                </div>
                <div id="estForm" style="display:none;">
                    <div class="est-summary" id="estProductSummary"></div>
                    <div class="form-field">
                        <label>회사(기관)명</label>
                        <input type="text" id="estCompany" placeholder="예: 에스티코난" class="est-input">
                    </div>
                    <div class="form-field">
                        <label>대표자(담당자)명</label>
                        <div style="display:flex;gap:8px;">
                            <input type="text" id="estRepresentative" placeholder="예: 유영환" class="est-input" style="flex:1;min-width:0;">
                            <select id="estTitle" style="flex:0 0 150px;width:150px;">
                                <option value="대표님">대표님</option>
                                <option value="총괄님">총괄님</option>
                                <option value="담당자님">담당자님</option>
                                <option value="이사님">이사님</option>
                                <option value="실장님">실장님</option>
                                <option value="부장님">부장님</option>
                                <option value="과장님">과장님</option>
                                <option value="대리님">대리님</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-field">
                        <label>영업 담당자</label>
                        <input type="text" id="estManager" value="고정현대리" class="est-input">
                    </div>
                    <div class="form-field">
                        <label>담당자 연락처</label>
                        <input type="tel" id="estPhone" value="010-4747-4644" class="est-input">
                    </div>
                    <div class="form-field">
                        <label>견적일자</label>
                        <input type="date" id="estDate" class="est-input">
                    </div>
                    <div class="form-field">
                        <label>렌탈 기간</label>
                        <select id="estPeriod">
                            <option value="">기간 선택</option>
                        </select>
                    </div>
                    <button class="est-download-btn" id="estDownloadBtn" onclick="generateQuotePDF()">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M12 5v14M5 12l7 7 7-7"/></svg>
                        PDF 견적서 다운로드
                    </button>
                </div>
            </div>
        </div>

        <!-- 히든 PDF 렌더링 컨테이너 -->
        <div id="pdfContainer" style="position:fixed;left:-9999px;top:0;z-index:-1;"></div>

        <!-- 경쟁력 비교 탭 -->
        <div id="tab-strength" class="tab-content">
            <div class="strength-section">
                <h2>현대전자칠판이 삼성/LG 보다 더 앞서있는 이유</h2>
                <div class="scroll-wrapper">
                    <img src="images/strength.jpg" alt="현대아이티 경쟁력 비교">
                </div>
                <p class="strength-tip">* 이미지를 좌우로 스크롤하거나 확대하여 상세 내용을 확인하세요.</p>
            </div>
            <div class="select-group" style="margin-top:18px;">
                <h2><span class="icon">&#128279;</span> 바로가기</h2>
                <a href="https://gw.hyundaiit.com/groupware/login.php" target="_blank" rel="noopener" style="display:flex;align-items:center;gap:10px;padding:14px 16px;background:#f5f7fa;border-radius:10px;text-decoration:none;color:#222;font-weight:600;font-size:15px;border:1px solid #e0e4ea;">
                    <span style="font-size:22px;">&#128188;</span> 그룹웨어 바로가기
                </a>
                <a href="emailins/01_현대아이티_회사소개서.pdf" download style="display:flex;align-items:center;gap:10px;padding:14px 16px;background:#f5f7fa;border-radius:10px;text-decoration:none;color:#222;font-weight:600;font-size:15px;border:1px solid #e0e4ea;margin-top:8px;">
                    <span style="font-size:22px;">&#128196;</span> 현대아이티 회사소개서
                </a>
                <a href="emailins/02_IX제품사양서.pdf" download style="display:flex;align-items:center;gap:10px;padding:14px 16px;background:#f5f7fa;border-radius:10px;text-decoration:none;color:#222;font-weight:600;font-size:15px;border:1px solid #e0e4ea;margin-top:8px;">
                    <span style="font-size:22px;">&#128196;</span> IX 제품사양서
                </a>
                <a href="emailins/03_MX_QLED_제품사양서.pdf" download style="display:flex;align-items:center;gap:10px;padding:14px 16px;background:#f5f7fa;border-radius:10px;text-decoration:none;color:#222;font-weight:600;font-size:15px;border:1px solid #e0e4ea;margin-top:8px;">
                    <span style="font-size:22px;">&#128196;</span> MX QLED 제품사양서
                </a>
                <a href="emailins/04_MX제품사양서.pdf" download style="display:flex;align-items:center;gap:10px;padding:14px 16px;background:#f5f7fa;border-radius:10px;text-decoration:none;color:#222;font-weight:600;font-size:15px;border:1px solid #e0e4ea;margin-top:8px;">
                    <span style="font-size:22px;">&#128196;</span> MX 제품사양서
                </a>
            </div>
        </div>

        <footer class="footer">
            &copy; 2026 현대아이티. All rights reserved.<br>
            개발: 전략유통사업본부<br>
            문의 : kjhyun@hyundaiit.com
        </footer>
    </main>

    <script>
    // 렌탈 데이터
    const DATA = {
        // MX 선납렌탈
        "MX선납렌탈": [
            {"size":"55\"","type":"벽걸이","typeDetail":"벽걸이형","deposit":500000,
             "prices":{"24":{"monthly":58500,"total":1904000},"36":{"monthly":44000,"total":2084000},"48":{"monthly":38700,"total":2357600},"60":{"monthly":36600,"total":2696000}},
             "spec":{"weight":"28kg","dimension":"1270.8 x 791.2mm","vesa":"-","resolution":"3840x2160"},"gift":"HDMI케이블, 데이터케이블"},
            {"size":"55\"","type":"원목","typeDetail":"원목스탠드","deposit":500000,
             "prices":{"24":{"monthly":67300,"total":2115200},"36":{"monthly":50400,"total":2314400},"48":{"monthly":44600,"total":2640800},"60":{"monthly":42000,"total":3020000}},
             "spec":{"weight":"28kg","dimension":"1270.8 x 791.2mm","vesa":"-","resolution":"3840x2160"},"gift":"HDMI케이블, 데이터케이블"},
            {"size":"65\"","type":"벽걸이","typeDetail":"벽걸이형","deposit":1000000,
             "prices":{"24":{"monthly":127000,"total":4048000},"36":{"monthly":95000,"total":4420000},"48":{"monthly":83000,"total":4984000},"60":{"monthly":78000,"total":5680000}},
             "spec":{"weight":"40kg","dimension":"1490 x 915mm","vesa":"600x400","resolution":"3840x2160"},"gift":"HDMI케이블, 데이터케이블"},
            {"size":"65\"","type":"전동","typeDetail":"전동스탠드","deposit":1000000,
             "prices":{"24":{"monthly":158000,"total":4792000},"36":{"monthly":118000,"total":5248000},"48":{"monthly":104000,"total":5992000},"60":{"monthly":97000,"total":6820000}},
             "spec":{"weight":"40kg","dimension":"1490 x 915mm","vesa":"600x400","resolution":"3840x2160"},"gift":"HDMI케이블, 데이터케이블"},
            {"size":"75\"","type":"벽걸이","typeDetail":"벽걸이형","deposit":1000000,
             "prices":{"24":{"monthly":143000,"total":4432000},"36":{"monthly":107000,"total":4852000},"48":{"monthly":93000,"total":5464000},"60":{"monthly":88000,"total":6280000}},
             "spec":{"weight":"50kg","dimension":"1714.4 x 1042.6mm","vesa":"800x600","resolution":"3840x2160"},"gift":"HDMI케이블, 데이터케이블"},
            {"size":"75\"","type":"전동","typeDetail":"전동스탠드","deposit":1000000,
             "prices":{"24":{"monthly":175000,"total":5200000},"36":{"monthly":132000,"total":5680000},"48":{"monthly":114000,"total":6472000},"60":{"monthly":106000,"total":7360000}},
             "spec":{"weight":"50kg","dimension":"1714.4 x 1042.6mm","vesa":"800x600","resolution":"3840x2160"},"gift":"HDMI케이블, 데이터케이블"},
            {"size":"86\"","type":"벽걸이","typeDetail":"벽걸이형","deposit":1000000,
             "prices":{"24":{"monthly":183000,"total":5392000},"36":{"monthly":137000,"total":5932000},"48":{"monthly":118000,"total":6664000},"60":{"monthly":111000,"total":7660000}},
             "spec":{"weight":"63kg","dimension":"1959.2 x 1180mm","vesa":"800x600","resolution":"3840x2160"},"gift":"HDMI케이블, 데이터케이블"},
            {"size":"86\"","type":"전동","typeDetail":"전동스탠드","deposit":1000000,
             "prices":{"24":{"monthly":215000,"total":6160000},"36":{"monthly":160000,"total":6760000},"48":{"monthly":140000,"total":7720000},"60":{"monthly":130000,"total":8800000}},
             "spec":{"weight":"63kg","dimension":"1959.2 x 1180mm","vesa":"800x600","resolution":"3840x2160"},"gift":"HDMI케이블, 데이터케이블"},
            {"size":"86\" 프리미엄","type":"벽걸이","typeDetail":"벽걸이형","deposit":1000000,
             "prices":{"24":{"monthly":204000,"total":5896000},"36":{"monthly":154000,"total":6544000},"48":{"monthly":134000,"total":7432000},"60":{"monthly":125000,"total":8500000}},
             "spec":{"weight":"63kg","dimension":"1959.2 x 1180mm","vesa":"800x600","resolution":"3840x2160","led":"QLED"},"gift":"HDMI케이블, 데이터케이블"},
            {"size":"86\" 프리미엄","type":"전동","typeDetail":"전동스탠드","deposit":1000000,
             "prices":{"24":{"monthly":236000,"total":6664000},"36":{"monthly":175000,"total":7300000},"48":{"monthly":153000,"total":8344000},"60":{"monthly":142000,"total":9520000}},
             "spec":{"weight":"63kg","dimension":"1959.2 x 1180mm","vesa":"800x600","resolution":"3840x2160","led":"QLED"},"gift":"HDMI케이블, 데이터케이블"},
            {"size":"98\"","type":"벽걸이","typeDetail":"벽걸이형","deposit":2000000,
             "prices":{"24":{"monthly":339700,"total":10152800},"36":{"monthly":253100,"total":11111600},"48":{"monthly":222900,"total":12699200},"60":{"monthly":207600,"total":14456000}},
             "spec":{"weight":"92kg","dimension":"2217 x 1331mm","vesa":"-","resolution":"3840x2160"},"gift":"HDMI케이블, 데이터케이블"},
            {"size":"98\"","type":"전동","typeDetail":"전동스탠드","deposit":2000000,
             "prices":{"24":{"monthly":370900,"total":10901600},"36":{"monthly":281900,"total":12148400},"48":{"monthly":248400,"total":13923200},"60":{"monthly":231000,"total":15860000}},
             "spec":{"weight":"92kg","dimension":"2217 x 1331mm","vesa":"-","resolution":"3840x2160"},"gift":"HDMI케이블, 데이터케이블"}
        ],
        // MX 일반렌탈
        "MX일반렌탈": [
            {"size":"55\"","type":"벽걸이","typeDetail":"벽걸이형","deposit":0,
             "prices":{"12":{"monthly":170000,"total":2040000},"24":{"monthly":94000,"total":2256000},"36":{"monthly":69000,"total":2484000},"48":{"monthly":56000,"total":2688000}},
             "spec":{"weight":"28kg","dimension":"1270.8 x 791.2mm","vesa":"-","resolution":"3840x2160"},"gift":"HDMI케이블, 데이터케이블"},
            {"size":"55\"","type":"원목","typeDetail":"원목스탠드","deposit":0,
             "prices":{"12":{"monthly":191000,"total":2292000},"24":{"monthly":105000,"total":2520000},"36":{"monthly":77000,"total":2772000},"48":{"monthly":63000,"total":3024000}},
             "spec":{"weight":"28kg","dimension":"1270.8 x 791.2mm","vesa":"-","resolution":"3840x2160"},"gift":"HDMI케이블, 데이터케이블"},
            {"size":"65\"","type":"벽걸이","typeDetail":"벽걸이형","deposit":0,
             "prices":{"12":{"monthly":365000,"total":4380000},"24":{"monthly":200000,"total":4800000},"36":{"monthly":147000,"total":5292000},"48":{"monthly":119000,"total":5712000}},
             "spec":{"weight":"40kg","dimension":"1490 x 915mm","vesa":"600x400","resolution":"3840x2160"},"gift":"HDMI케이블, 데이터케이블"},
            {"size":"65\"","type":"전동","typeDetail":"전동스탠드","deposit":0,
             "prices":{"12":{"monthly":436000,"total":5232000},"24":{"monthly":239000,"total":5736000},"36":{"monthly":175000,"total":6300000},"48":{"monthly":143000,"total":6864000}},
             "spec":{"weight":"40kg","dimension":"1490 x 915mm","vesa":"600x400","resolution":"3840x2160"},"gift":"HDMI케이블, 데이터케이블"},
            {"size":"75\"","type":"벽걸이","typeDetail":"벽걸이형","deposit":0,
             "prices":{"12":{"monthly":399000,"total":4788000},"24":{"monthly":220000,"total":5280000},"36":{"monthly":162000,"total":5832000},"48":{"monthly":130000,"total":6240000}},
             "spec":{"weight":"50kg","dimension":"1714.4 x 1042.6mm","vesa":"800x600","resolution":"3840x2160"},"gift":"HDMI케이블, 데이터케이블"},
            {"size":"75\"","type":"전동","typeDetail":"전동스탠드","deposit":0,
             "prices":{"12":{"monthly":473000,"total":5676000},"24":{"monthly":260000,"total":6240000},"36":{"monthly":190000,"total":6840000},"48":{"monthly":155000,"total":7440000}},
             "spec":{"weight":"50kg","dimension":"1714.4 x 1042.6mm","vesa":"800x600","resolution":"3840x2160"},"gift":"HDMI케이블, 데이터케이블"},
            {"size":"86\"","type":"벽걸이","typeDetail":"벽걸이형","deposit":0,
             "prices":{"12":{"monthly":490000,"total":5880000},"24":{"monthly":271000,"total":6504000},"36":{"monthly":199000,"total":7164000},"48":{"monthly":160000,"total":7680000}},
             "spec":{"weight":"63kg","dimension":"1959.2 x 1180mm","vesa":"800x600","resolution":"3840x2160"},"gift":"HDMI케이블, 데이터케이블"},
            {"size":"86\"","type":"전동","typeDetail":"전동스탠드","deposit":0,
             "prices":{"12":{"monthly":566000,"total":6792000},"24":{"monthly":311000,"total":7464000},"36":{"monthly":228000,"total":8208000},"48":{"monthly":186000,"total":8928000}},
             "spec":{"weight":"63kg","dimension":"1959.2 x 1180mm","vesa":"800x600","resolution":"3840x2160"},"gift":"HDMI케이블, 데이터케이블"},
            {"size":"86\" 프리미엄","type":"벽걸이","typeDetail":"벽걸이형","deposit":0,
             "prices":{"12":{"monthly":540000,"total":6480000},"24":{"monthly":297000,"total":7128000},"36":{"monthly":220000,"total":7920000},"48":{"monthly":178000,"total":8544000}},
             "spec":{"weight":"63kg","dimension":"1959.2 x 1180mm","vesa":"800x600","resolution":"3840x2160","led":"QLED"},"gift":"HDMI케이블, 데이터케이블"},
            {"size":"86\" 프리미엄","type":"전동","typeDetail":"전동스탠드","deposit":0,
             "prices":{"12":{"monthly":612000,"total":7344000},"24":{"monthly":337000,"total":8088000},"36":{"monthly":246000,"total":8856000},"48":{"monthly":201000,"total":9648000}},
             "spec":{"weight":"63kg","dimension":"1959.2 x 1180mm","vesa":"800x600","resolution":"3840x2160","led":"QLED"},"gift":"HDMI케이블, 데이터케이블"},
            {"size":"98\"","type":"벽걸이","typeDetail":"벽걸이형","deposit":0,
             "prices":{"12":{"monthly":924000,"total":11088000},"24":{"monthly":508000,"total":12192000},"36":{"monthly":372000,"total":13392000},"48":{"monthly":304000,"total":14592000}},
             "spec":{"weight":"92kg","dimension":"2217 x 1331mm","vesa":"-","resolution":"3840x2160"},"gift":"HDMI케이블, 데이터케이블"},
            {"size":"98\"","type":"전동","typeDetail":"전동스탠드","deposit":0,
             "prices":{"12":{"monthly":977000,"total":11724000},"24":{"monthly":547000,"total":13128000},"36":{"monthly":401000,"total":14436000},"48":{"monthly":327000,"total":15696000}},
             "spec":{"weight":"92kg","dimension":"2217 x 1331mm","vesa":"-","resolution":"3840x2160"},"gift":"HDMI케이블, 데이터케이블"}
        ],
        // IX 선납렌탈
        "IX선납렌탈": [
            {"size":"65\"","type":"벽걸이","typeDetail":"벽걸이형","deposit":1000000,
             "prices":{"24":{"monthly":166000,"total":4984000},"36":{"monthly":123400,"total":5442400},"48":{"monthly":108900,"total":6227200},"60":{"monthly":100000,"total":7000000}},
             "spec":{"weight":"37kg","dimension":"1490 x 915mm","vesa":"600x400","resolution":"3840x2160"},"gift":"고급사운드바, 무선미러링동글, 트랙볼키보드, 썬더볼트C to C(1m), 스마트펜, 일반전자펜2, 핫키장착, 3년AS, 액정파손1회무료, 전담CX매니저, 판서(50만)"},
            {"size":"65\"","type":"전동","typeDetail":"전동스탠드","deposit":1000000,
             "prices":{"24":{"monthly":199000,"total":5776000},"36":{"monthly":146500,"total":6274000},"48":{"monthly":128000,"total":7144000},"60":{"monthly":118000,"total":8080000}},
             "spec":{"weight":"37kg","dimension":"1490 x 915mm","vesa":"600x400","resolution":"3840x2160"},"gift":"고급사운드바, 무선미러링동글, 트랙볼키보드, 썬더볼트C to C(1m), 스마트펜, 일반전자펜2, 핫키장착, 3년AS, 액정파손1회무료, 전담CX매니저, 판서(50만)"},
            {"size":"65\"","type":"벽걸이","typeDetail":"벽걸이형","deposit":2000000,
             "prices":{"36":{"monthly":88500,"total":5186000},"48":{"monthly":80500,"total":5864000},"60":{"monthly":75900,"total":6554000}},
             "spec":{"weight":"37kg","dimension":"1490 x 915mm","vesa":"600x400","resolution":"3840x2160"},"gift":"고급사운드바, 무선미러링동글, 트랙볼키보드, 썬더볼트C to C(1m), 스마트펜, 일반전자펜2, 핫키장착, 3년AS, 액정파손1회무료, 전담CX매니저, 판서(50만)"},
            {"size":"65\"","type":"전동","typeDetail":"전동스탠드","deposit":2000000,
             "prices":{"36":{"monthly":108800,"total":5916800},"48":{"monthly":97700,"total":6689600},"60":{"monthly":92000,"total":7520000}},
             "spec":{"weight":"37kg","dimension":"1490 x 915mm","vesa":"600x400","resolution":"3840x2160"},"gift":"고급사운드바, 무선미러링동글, 트랙볼키보드, 썬더볼트C to C(1m), 스마트펜, 일반전자펜2, 핫키장착, 3년AS, 액정파손1회무료, 전담CX매니저, 판서(50만)"},
            {"size":"75\"","type":"벽걸이","typeDetail":"벽걸이형","deposit":1000000,
             "prices":{"24":{"monthly":206000,"total":5944000},"36":{"monthly":152900,"total":6504400},"48":{"monthly":134400,"total":7451200},"60":{"monthly":123000,"total":8380000}},
             "spec":{"weight":"51kg","dimension":"1714.4 x 1042.6mm","vesa":"800x600","resolution":"3840x2160"},"gift":"고급사운드바, 무선미러링동글, 트랙볼키보드, 썬더볼트C to C(1m), 스마트펜, 일반전자펜2, 핫키장착, 3년AS, 액정파손1회무료, 전담CX매니저, 판서(50만)"},
            {"size":"75\"","type":"전동","typeDetail":"전동스탠드","deposit":1000000,
             "prices":{"24":{"monthly":238000,"total":6712000},"36":{"monthly":176000,"total":7336000},"48":{"monthly":153900,"total":8387200},"60":{"monthly":142000,"total":9520000}},
             "spec":{"weight":"51kg","dimension":"1714.4 x 1042.6mm","vesa":"800x600","resolution":"3840x2160"},"gift":"고급사운드바, 무선미러링동글, 트랙볼키보드, 썬더볼트C to C(1m), 스마트펜, 일반전자펜2, 핫키장착, 3년AS, 액정파손1회무료, 전담CX매니저, 판서(50만)"},
            {"size":"75\"","type":"벽걸이","typeDetail":"벽걸이형","deposit":2000000,
             "prices":{"36":{"monthly":114400,"total":6118400},"48":{"monthly":103000,"total":6944000},"60":{"monthly":96800,"total":7808000}},
             "spec":{"weight":"51kg","dimension":"1714.4 x 1042.6mm","vesa":"800x600","resolution":"3840x2160"},"gift":"고급사운드바, 무선미러링동글, 트랙볼키보드, 썬더볼트C to C(1m), 스마트펜, 일반전자펜2, 핫키장착, 3년AS, 액정파손1회무료, 전담CX매니저, 판서(50만)"},
            {"size":"75\"","type":"전동","typeDetail":"전동스탠드","deposit":2000000,
             "prices":{"36":{"monthly":134700,"total":6849200},"48":{"monthly":120200,"total":7769600},"60":{"monthly":112900,"total":8774000}},
             "spec":{"weight":"51kg","dimension":"1714.4 x 1042.6mm","vesa":"800x600","resolution":"3840x2160"},"gift":"고급사운드바, 무선미러링동글, 트랙볼키보드, 썬더볼트C to C(1m), 스마트펜, 일반전자펜2, 핫키장착, 3년AS, 액정파손1회무료, 전담CX매니저, 판서(50만)"},
            {"size":"86\"","type":"벽걸이","typeDetail":"벽걸이형","deposit":1000000,
             "prices":{"24":{"monthly":244000,"total":6856000},"36":{"monthly":180000,"total":7480000},"48":{"monthly":157300,"total":8550400},"60":{"monthly":145000,"total":9700000}},
             "spec":{"weight":"66kg","dimension":"1956.8 x 1178.4mm","vesa":"800x600","resolution":"3840x2160"},"gift":"고급사운드바, 무선미러링동글, 트랙볼키보드, 썬더볼트C to C(1m), 스마트펜, 일반전자펜2, 핫키장착, 3년AS, 액정파손1회무료, 전담CX매니저, 판서(50만)"},
            {"size":"86\"","type":"전동","typeDetail":"전동스탠드","deposit":1000000,
             "prices":{"24":{"monthly":275000,"total":7600000},"36":{"monthly":202000,"total":8272000},"48":{"monthly":177700,"total":9529600},"60":{"monthly":163000,"total":10780000}},
             "spec":{"weight":"66kg","dimension":"1956.8 x 1178.4mm","vesa":"800x600","resolution":"3840x2160"},"gift":"고급사운드바, 무선미러링동글, 트랙볼키보드, 썬더볼트C to C(1m), 스마트펜, 일반전자펜2, 핫키장착, 3년AS, 액정파손1회무료, 전담CX매니저, 판서(50만)"},
            {"size":"86\"","type":"벽걸이","typeDetail":"벽걸이형","deposit":2000000,
             "prices":{"36":{"monthly":138200,"total":6975200},"48":{"monthly":123200,"total":7913600},"60":{"monthly":115600,"total":8936000}},
             "spec":{"weight":"66kg","dimension":"1956.8 x 1178.4mm","vesa":"800x600","resolution":"3840x2160"},"gift":"고급사운드바, 무선미러링동글, 트랙볼키보드, 썬더볼트C to C(1m), 스마트펜, 일반전자펜2, 핫키장착, 3년AS, 액정파손1회무료, 전담CX매니저, 판서(50만)"},
            {"size":"86\"","type":"전동","typeDetail":"전동스탠드","deposit":2000000,
             "prices":{"36":{"monthly":157800,"total":7680800},"48":{"monthly":141200,"total":8777600},"60":{"monthly":131800,"total":9908000}},
             "spec":{"weight":"66kg","dimension":"1956.8 x 1178.4mm","vesa":"800x600","resolution":"3840x2160"},"gift":"고급사운드바, 무선미러링동글, 트랙볼키보드, 썬더볼트C to C(1m), 스마트펜, 일반전자펜2, 핫키장착, 3년AS, 액정파손1회무료, 전담CX매니저, 판서(50만)"},
            {"size":"98\"","type":"벽걸이","typeDetail":"벽걸이형","deposit":2000000,
             "prices":{"24":{"monthly":380000,"total":11120000},"36":{"monthly":282000,"total":12152000},"48":{"monthly":248300,"total":13918400},"60":{"monthly":229000,"total":15740000}},
             "spec":{"weight":"86kg","dimension":"2219.6 x 1326.3mm","vesa":"-","resolution":"3840x2160"},"gift":"고급사운드바, 무선미러링동글, 트랙볼키보드, 썬더볼트C to C(1m), 스마트펜, 일반전자펜2, 핫키장착, 3년AS, 액정파손1회무료, 전담CX매니저, 판서(50만)"},
            {"size":"98\"","type":"전동","typeDetail":"전동스탠드","deposit":2000000,
             "prices":{"24":{"monthly":411700,"total":11880800},"36":{"monthly":305900,"total":13012400},"48":{"monthly":268800,"total":14902400},"60":{"monthly":247000,"total":16820000}},
             "spec":{"weight":"86kg","dimension":"2219.6 x 1326.3mm","vesa":"-","resolution":"3840x2160"},"gift":"고급사운드바, 무선미러링동글, 트랙볼키보드, 썬더볼트C to C(1m), 스마트펜, 일반전자펜2, 핫키장착, 3년AS, 액정파손1회무료, 전담CX매니저, 판서(50만)"},
            {"size":"98\"","type":"벽걸이","typeDetail":"벽걸이형","deposit":4000000,
             "prices":{"36":{"monthly":208500,"total":11506000},"48":{"monthly":188000,"total":13024000},"60":{"monthly":176900,"total":14614000}},
             "spec":{"weight":"86kg","dimension":"2219.6 x 1326.3mm","vesa":"-","resolution":"3840x2160"},"gift":"고급사운드바, 무선미러링동글, 트랙볼키보드, 썬더볼트C to C(1m), 스마트펜, 일반전자펜2, 핫키장착, 3년AS, 액정파손1회무료, 전담CX매니저, 판서(50만)"},
            {"size":"98\"","type":"전동","typeDetail":"전동스탠드","deposit":4000000,
             "prices":{"36":{"monthly":228800,"total":12236800},"48":{"monthly":206000,"total":13888000},"60":{"monthly":193000,"total":15580000}},
             "spec":{"weight":"86kg","dimension":"2219.6 x 1326.3mm","vesa":"-","resolution":"3840x2160"},"gift":"고급사운드바, 무선미러링동글, 트랙볼키보드, 썬더볼트C to C(1m), 스마트펜, 일반전자펜2, 핫키장착, 3년AS, 액정파손1회무료, 전담CX매니저, 판서(50만)"}
        ],
        // IX 일반렌탈
        "IX일반렌탈": [
            {"size":"65\"","type":"벽걸이","typeDetail":"벽걸이형","deposit":0,
             "prices":{"12":{"monthly":453000,"total":5436000},"24":{"monthly":249000,"total":5976000},"36":{"monthly":182000,"total":6552000},"48":{"monthly":149000,"total":7152000}},
             "spec":{"weight":"37kg","dimension":"1490 x 915mm","vesa":"600x400","resolution":"3840x2160"},"gift":"고급사운드바, 무선미러링동글, 트랙볼키보드, 썬더볼트C to C(1m), 스마트펜, 일반전자펜2, 핫키장착, 3년AS, 액정파손1회무료, 전담CX매니저, 판서(50만)"},
            {"size":"65\"","type":"전동","typeDetail":"전동스탠드","deposit":0,
             "prices":{"12":{"monthly":524000,"total":6288000},"24":{"monthly":288000,"total":6912000},"36":{"monthly":211000,"total":7596000},"48":{"monthly":172000,"total":8256000}},
             "spec":{"weight":"37kg","dimension":"1490 x 915mm","vesa":"600x400","resolution":"3840x2160"},"gift":"고급사운드바, 무선미러링동글, 트랙볼키보드, 썬더볼트C to C(1m), 스마트펜, 일반전자펜2, 핫키장착, 3년AS, 액정파손1회무료, 전담CX매니저, 판서(50만)"},
            {"size":"75\"","type":"벽걸이","typeDetail":"벽걸이형","deposit":0,
             "prices":{"12":{"monthly":545000,"total":6540000},"24":{"monthly":299000,"total":7176000},"36":{"monthly":219000,"total":7884000},"48":{"monthly":179000,"total":8592000}},
             "spec":{"weight":"51kg","dimension":"1714.4 x 1042.6mm","vesa":"800x600","resolution":"3840x2160"},"gift":"고급사운드바, 무선미러링동글, 트랙볼키보드, 썬더볼트C to C(1m), 스마트펜, 일반전자펜2, 핫키장착, 3년AS, 액정파손1회무료, 전담CX매니저, 판서(50만)"},
            {"size":"75\"","type":"전동","typeDetail":"전동스탠드","deposit":0,
             "prices":{"12":{"monthly":616000,"total":7392000},"24":{"monthly":339000,"total":8136000},"36":{"monthly":248000,"total":8928000},"48":{"monthly":202000,"total":9696000}},
             "spec":{"weight":"51kg","dimension":"1714.4 x 1042.6mm","vesa":"800x600","resolution":"3840x2160"},"gift":"고급사운드바, 무선미러링동글, 트랙볼키보드, 썬더볼트C to C(1m), 스마트펜, 일반전자펜2, 핫키장착, 3년AS, 액정파손1회무료, 전담CX매니저, 판서(50만)"},
            {"size":"86\"","type":"벽걸이","typeDetail":"벽걸이형","deposit":0,
             "prices":{"12":{"monthly":629000,"total":7548000},"24":{"monthly":345000,"total":8280000},"36":{"monthly":253000,"total":9108000},"48":{"monthly":206000,"total":9888000}},
             "spec":{"weight":"66kg","dimension":"1956.8 x 1178.4mm","vesa":"800x600","resolution":"3840x2160"},"gift":"고급사운드바, 무선미러링동글, 트랙볼키보드, 썬더볼트C to C(1m), 스마트펜, 일반전자펜2, 핫키장착, 3년AS, 액정파손1회무료, 전담CX매니저, 판서(50만)"},
            {"size":"86\"","type":"전동","typeDetail":"전동스탠드","deposit":0,
             "prices":{"12":{"monthly":700000,"total":8400000},"24":{"monthly":384000,"total":9216000},"36":{"monthly":281000,"total":10116000},"48":{"monthly":230000,"total":11040000}},
             "spec":{"weight":"66kg","dimension":"1956.8 x 1178.4mm","vesa":"800x600","resolution":"3840x2160"},"gift":"고급사운드바, 무선미러링동글, 트랙볼키보드, 썬더볼트C to C(1m), 스마트펜, 일반전자펜2, 핫키장착, 3년AS, 액정파손1회무료, 전담CX매니저, 판서(50만)"},
            {"size":"98\"","type":"벽걸이","typeDetail":"벽걸이형","deposit":0,
             "prices":{"12":{"monthly":1017000,"total":12204000},"24":{"monthly":559000,"total":13416000},"36":{"monthly":409000,"total":14724000},"48":{"monthly":334000,"total":16032000}},
             "spec":{"weight":"86kg","dimension":"2219.6 x 1326.3mm","vesa":"-","resolution":"3840x2160"},"gift":"고급사운드바, 무선미러링동글, 트랙볼키보드, 썬더볼트C to C(1m), 스마트펜, 일반전자펜2, 핫키장착, 3년AS, 액정파손1회무료, 전담CX매니저, 판서(50만)"},
            {"size":"98\"","type":"전동","typeDetail":"전동스탠드","deposit":0,
             "prices":{"12":{"monthly":1088000,"total":13056000},"24":{"monthly":598000,"total":14352000},"36":{"monthly":438000,"total":15768000},"48":{"monthly":358000,"total":17184000}},
             "spec":{"weight":"86kg","dimension":"2219.6 x 1326.3mm","vesa":"-","resolution":"3840x2160"},"gift":"고급사운드바, 무선미러링동글, 트랙볼키보드, 썬더볼트C to C(1m), 스마트펜, 일반전자펜2, 핫키장착, 3년AS, 액정파손1회무료, 전담CX매니저, 판서(50만)"}
        ],
        // 저가형 선납렌탈
        "저가형선납렌탈": [
            {"line":"N Series","size":"NA 86\"","type":"벽걸이","typeDetail":"벽걸이형","deposit":1000000,
             "prices":{"24":{"monthly":121000,"total":3904000},"36":{"monthly":91000,"total":4276000},"48":{"monthly":80000,"total":4840000},"60":{"monthly":75000,"total":5500000}},
             "spec":{"weight":"-","dimension":"-","vesa":"-","resolution":"3840x2160"}},
            {"line":"N Series","size":"NA 86\"","type":"전동","typeDetail":"전동스탠드","deposit":1000000,
             "prices":{"24":{"monthly":144000,"total":4456000},"36":{"monthly":108000,"total":4888000},"48":{"monthly":95000,"total":5560000},"60":{"monthly":89000,"total":6340000}},
             "spec":{"weight":"-","dimension":"-","vesa":"-","resolution":"3840x2160"}},
            {"line":"N Series","size":"NW 86\"","type":"벽걸이","typeDetail":"벽걸이형","deposit":1000000,
             "prices":{"24":{"monthly":160000,"total":4840000},"36":{"monthly":116000,"total":5176000},"48":{"monthly":100000,"total":5800000},"60":{"monthly":91000,"total":6460000}},
             "spec":{"weight":"-","dimension":"-","vesa":"-","resolution":"3840x2160"}},
            {"line":"N Series","size":"NW 86\"","type":"전동","typeDetail":"전동스탠드","deposit":1000000,
             "prices":{"24":{"monthly":195000,"total":5680000},"36":{"monthly":141000,"total":6076000},"48":{"monthly":122000,"total":6856000},"60":{"monthly":110000,"total":7600000}},
             "spec":{"weight":"-","dimension":"-","vesa":"-","resolution":"3840x2160"}},
            {"line":"A11","size":"75\"","type":"벽걸이","typeDetail":"벽걸이형","deposit":1000000,
             "prices":{"24":{"monthly":80000,"total":2920000},"36":{"monthly":61000,"total":3196000},"48":{"monthly":55000,"total":3640000},"60":{"monthly":52000,"total":4120000}},
             "spec":{"weight":"-","dimension":"-","vesa":"-","resolution":"3840x2160"}},
            {"line":"A11","size":"75\"","type":"전동","typeDetail":"전동스탠드","deposit":1000000,
             "prices":{"24":{"monthly":111000,"total":3664000},"36":{"monthly":84000,"total":4024000},"48":{"monthly":75000,"total":4600000},"60":{"monthly":70000,"total":5200000}},
             "spec":{"weight":"-","dimension":"-","vesa":"-","resolution":"3840x2160"}},
            {"line":"A13","size":"65\"","type":"벽걸이","typeDetail":"벽걸이형","deposit":1000000,
             "prices":{"24":{"monthly":80000,"total":2920000},"36":{"monthly":61000,"total":3196000},"48":{"monthly":55000,"total":3640000},"60":{"monthly":52000,"total":4120000}},
             "spec":{"weight":"-","dimension":"-","vesa":"-","resolution":"3840x2160"}},
            {"line":"A13","size":"65\"","type":"전동","typeDetail":"전동스탠드","deposit":1000000,
             "prices":{"24":{"monthly":111000,"total":3664000},"36":{"monthly":84000,"total":4024000},"48":{"monthly":75000,"total":4600000},"60":{"monthly":70000,"total":5200000}},
             "spec":{"weight":"-","dimension":"-","vesa":"-","resolution":"3840x2160"}},
            {"line":"α 3.0","size":"86\"","type":"벽걸이","typeDetail":"벽걸이형","deposit":1000000,
             "prices":{"24":{"monthly":94000,"total":3256000},"36":{"monthly":70000,"total":3520000},"48":{"monthly":62000,"total":3976000},"60":{"monthly":59000,"total":4540000}},
             "spec":{"weight":"-","dimension":"-","vesa":"-","resolution":"3840x2160"}},
            {"line":"α 3.0","size":"86\"","type":"전동","typeDetail":"전동스탠드","deposit":1000000,
             "prices":{"24":{"monthly":124000,"total":3976000},"36":{"monthly":93000,"total":4348000},"48":{"monthly":83000,"total":4984000},"60":{"monthly":77000,"total":5620000}},
             "spec":{"weight":"-","dimension":"-","vesa":"-","resolution":"3840x2160"}}
        ],
        // 저가형 일반렌탈
        "저가형일반렌탈": [
            {"line":"N Series","size":"NA 86\"","type":"벽걸이","typeDetail":"벽걸이형","deposit":0,
             "prices":{"12":{"monthly":351000,"total":4212000},"24":{"monthly":193000,"total":4632000},"36":{"monthly":141000,"total":5076000},"48":{"monthly":115000,"total":5520000}},
             "spec":{"weight":"-","dimension":"-","vesa":"-","resolution":"3840x2160"}},
            {"line":"N Series","size":"NA 86\"","type":"전동","typeDetail":"전동스탠드","deposit":0,
             "prices":{"12":{"monthly":404000,"total":4848000},"24":{"monthly":222000,"total":5328000},"36":{"monthly":163000,"total":5868000},"48":{"monthly":133000,"total":6384000}},
             "spec":{"weight":"-","dimension":"-","vesa":"-","resolution":"3840x2160"}},
            {"line":"N Series","size":"NW 86\"","type":"벽걸이","typeDetail":"벽걸이형","deposit":0,
             "prices":{"12":{"monthly":412000,"total":4944000},"24":{"monthly":242000,"total":5808000},"36":{"monthly":173000,"total":6228000},"48":{"monthly":139000,"total":6672000}},
             "spec":{"weight":"-","dimension":"-","vesa":"-","resolution":"3840x2160"}},
            {"line":"N Series","size":"NW 86\"","type":"전동","typeDetail":"전동스탠드","deposit":0,
             "prices":{"12":{"monthly":486000,"total":5832000},"24":{"monthly":285000,"total":6840000},"36":{"monthly":204000,"total":7344000},"48":{"monthly":164000,"total":7872000}},
             "spec":{"weight":"-","dimension":"-","vesa":"-","resolution":"3840x2160"}},
            {"line":"A11","size":"75\"","type":"벽걸이","typeDetail":"벽걸이형","deposit":0,
             "prices":{"12":{"monthly":259000,"total":3108000},"24":{"monthly":142000,"total":3408000},"36":{"monthly":104000,"total":3744000},"48":{"monthly":85000,"total":4080000}},
             "spec":{"weight":"-","dimension":"-","vesa":"-","resolution":"3840x2160"}},
            {"line":"A11","size":"75\"","type":"전동","typeDetail":"전동스탠드","deposit":0,
             "prices":{"12":{"monthly":330000,"total":3960000},"24":{"monthly":181000,"total":4344000},"36":{"monthly":133000,"total":4788000},"48":{"monthly":109000,"total":5232000}},
             "spec":{"weight":"-","dimension":"-","vesa":"-","resolution":"3840x2160"}},
            {"line":"A13","size":"65\"","type":"벽걸이","typeDetail":"벽걸이형","deposit":0,
             "prices":{"12":{"monthly":259000,"total":3108000},"24":{"monthly":142000,"total":3408000},"36":{"monthly":104000,"total":3744000},"48":{"monthly":85000,"total":4080000}},
             "spec":{"weight":"-","dimension":"-","vesa":"-","resolution":"3840x2160"}},
            {"line":"A13","size":"65\"","type":"전동","typeDetail":"전동스탠드","deposit":0,
             "prices":{"12":{"monthly":330000,"total":3960000},"24":{"monthly":181000,"total":4344000},"36":{"monthly":133000,"total":4788000},"48":{"monthly":109000,"total":5232000}},
             "spec":{"weight":"-","dimension":"-","vesa":"-","resolution":"3840x2160"}},
            {"line":"α 3.0","size":"86\"","type":"벽걸이","typeDetail":"벽걸이형","deposit":0,
             "prices":{"12":{"monthly":287000,"total":3444000},"24":{"monthly":158000,"total":3792000},"36":{"monthly":115000,"total":4140000},"48":{"monthly":94000,"total":4512000}},
             "spec":{"weight":"-","dimension":"-","vesa":"-","resolution":"3840x2160"}},
            {"line":"α 3.0","size":"86\"","type":"전동","typeDetail":"전동스탠드","deposit":0,
             "prices":{"12":{"monthly":358000,"total":4296000},"24":{"monthly":197000,"total":4728000},"36":{"monthly":144000,"total":5184000},"48":{"monthly":118000,"total":5664000}},
             "spec":{"weight":"-","dimension":"-","vesa":"-","resolution":"3840x2160"}}
        ]
    };

    let currentRentalType = '선납렌탈';
    let currentCategory = null;
    let currentItem = null;
    let deferredPrompt = null;

    // PDF 견적서용 보조 데이터
    const PDF_MODELS = {
        'MX':{'55"':'MX55NZPI','65"':'MX65NZPI','75"':'MX75NZPI','86"':'MX86NZPI','86" 프리미엄':'MX86QNZPI','98"':'MX98NZPI'},
        'IX':{'65"':'IX65NZPI','75"':'IX75NZPI','86"':'IX86NZPI','98"':'IX98NZPI'}
    };
    const PDF_SPECS = {
        'MX': {
            main:'광시야각 IPS 패널, 4K UHD, Zero Gap Bonding R.P.Glass(빛방사방지), Knob Dial Hot Key, 지문인식 화상교육 장치(8k 카메라, 마이크 8개, 스피커+우퍼) 기본 내장',
            comp:'리모콘, 스마트터치펜2개, HDMI 케이블, 터치케이블, 미팅메이트 판서 프로그램 USB'
        },
        'IX': {
            main:'광시야각 IPS 패널, 4K UHD, Zero Gap Bonding R.P.Glass(빛방사방지), Knob Dial Hot Key 화상교육 장치(8k 카메라, 마이크 8개, 스피커+우퍼) 기본 내장',
            comp:'리모콘, 스마트터치펜2개, HDMI 케이블, 터치케이블, 미팅메이트 판서 프로그램 USB'
        },
        '저가형': {
            main:'4K UHD, 안드로이드 OS 내장',
            comp:'리모콘, 전자펜, HDMI 케이블, 터치케이블'
        }
    };
    const PDF_STANDS = {
        '선반':{name:'선반 스탠드',model:'1800S',spec:'거치 가능 무게 : 최대 141Kg\nVESA 지원 : 800 x 600\n32~100인치 제품 거치 가능',dim:'1060 x 1665 x 465 (mm) / 22.5kg',price:440000},
        '전동':{name:'전동 스탠드',model:'SD1192',spec:'리모콘으로 높낮이 조절, 승하강속도 500mm/s\n최대하중 400kg,\n65~92인치 제품 거치 가능',dim:'1276 x 800 x 1080~1580 (mm) / 49kg',price:770000},
        '원목':{name:'원목 스탠드',model:'WS-1800',spec:'VESA 지원 : 800 x 600\n32~86인치 제품 거치 가능',dim:'600 x 450 x 1200 (mm) / 15kg',price:330000}
    };

    // 유틸: 숫자 포맷
    function fmt(n) {
        return n.toLocaleString('ko-KR');
    }

    // 유틸: HTML attribute 이스케이프
    function esc(s) {
        return s.replace(/&/g,'&amp;').replace(/"/g,'&quot;');
    }

    // 카테고리 색상
    function getCatColor(cat) {
        if (cat === 'MX') return 'blue';
        if (cat === 'IX') return 'red';
        if (cat === '저가형') return 'green';
        return 'blue';
    }

    // 탭 전환
    function switchTab(tab) {
        document.querySelectorAll('.tab-content').forEach(el => el.classList.remove('active'));
        document.querySelectorAll('.tab-btn').forEach(el => el.classList.remove('active'));
        document.getElementById('tab-' + tab).classList.add('active');
        event.target.classList.add('active');
        if (tab === 'estimate') updateEstimateTab();
    }

    // 렌탈 유형 선택
    function selectRentalType(type) {
        currentRentalType = type;
        document.querySelectorAll('.rental-type-badge').forEach(el => {
            el.classList.toggle('active', el.dataset.type === type);
        });

        // 안내문구 업데이트
        const noticeDeposit = document.getElementById('noticeDeposit');
        if (type === '일반렌탈') {
            noticeDeposit.textContent = '* 일반 렌탈 상품으로, 선납금 없이 월 렌탈료만 납부합니다.';
        } else {
            noticeDeposit.textContent = '* 선납 렌탈 상품으로, 선납금은 계약 시 납부합니다.';
        }

        // 현재 선택된 카테고리가 있으면 다시 로드
        if (currentCategory) {
            selectCategory(currentCategory);
        }
    }

    // 현재 데이터 키 가져오기
    function getDataKey() {
        return currentCategory + currentRentalType;
    }

    // 현재 데이터 배열 가져오기
    function getCurrentData() {
        const key = getDataKey();
        return DATA[key] || [];
    }

    // 카테고리 선택
    function selectCategory(cat) {
        currentCategory = cat;
        document.querySelectorAll('.category-badge').forEach(el => {
            el.classList.toggle('active', el.dataset.cat === cat);
        });

        const data = getCurrentData();
        const selSize = document.getElementById('selSize');

        // 저가형은 라인별로 사이즈 표시
        let sizes;
        if (cat === '저가형') {
            sizes = [...new Set(data.map(d => d.line + ' ' + d.size))];
        } else {
            sizes = [...new Set(data.map(d => d.size))];
        }

        selSize.innerHTML = '<option value="">화면 크기 선택</option>';
        sizes.forEach(s => {
            selSize.innerHTML += `<option value="${esc(s)}">${s}</option>`;
        });
        selSize.disabled = false;
        resetFrom('type');
    }

    // 화면 크기 변경
    function onSizeChange() {
        const sizeVal = document.getElementById('selSize').value;
        if (!sizeVal) { resetFrom('type'); return; }

        const data = getCurrentData();
        const selType = document.getElementById('selType');

        let filtered;
        if (currentCategory === '저가형') {
            const [line, ...sizeParts] = sizeVal.split(' ');
            const size = sizeParts.join(' ');
            filtered = data.filter(d => d.line === line && d.size === size);
        } else {
            filtered = data.filter(d => d.size === sizeVal);
        }

        const types = [...new Set(filtered.map(d => d.type))];

        selType.innerHTML = '<option value="">설치 타입 선택</option>';
        types.forEach(t => {
            selType.innerHTML += `<option value="${t}">${t}</option>`;
        });
        selType.disabled = false;
        resetFrom('deposit');
    }

    // 설치 타입 변경
    function onTypeChange() {
        const sizeVal = document.getElementById('selSize').value;
        const type = document.getElementById('selType').value;
        if (!type) { resetFrom('deposit'); return; }

        const data = getCurrentData();
        let filtered;
        if (currentCategory === '저가형') {
            const [line, ...sizeParts] = sizeVal.split(' ');
            const size = sizeParts.join(' ');
            filtered = data.filter(d => d.line === line && d.size === size && d.type === type);
        } else {
            filtered = data.filter(d => d.size === sizeVal && d.type === type);
        }

        const deposits = [...new Set(filtered.map(d => d.deposit))];

        if (deposits.length > 1) {
            const selDeposit = document.getElementById('selDeposit');
            const depositField = document.getElementById('depositField');
            selDeposit.innerHTML = '<option value="">선납금 선택</option>';
            deposits.sort((a, b) => a - b).forEach(dep => {
                selDeposit.innerHTML += `<option value="${dep}">${fmt(dep)}원</option>`;
            });
            selDeposit.disabled = false;
            depositField.style.display = 'block';
            hideResult();
        } else {
            document.getElementById('depositField').style.display = 'none';
            showResult(sizeVal, type, deposits[0]);
        }
    }

    // 선납금 변경
    function onDepositChange() {
        const sizeVal = document.getElementById('selSize').value;
        const type = document.getElementById('selType').value;
        const deposit = parseInt(document.getElementById('selDeposit').value);
        if (isNaN(deposit)) { hideResult(); return; }

        showResult(sizeVal, type, deposit);
    }

    // 결과 표시
    function showResult(sizeVal, type, deposit) {
        const data = getCurrentData();
        let item;

        if (currentCategory === '저가형') {
            const [line, ...sizeParts] = sizeVal.split(' ');
            const size = sizeParts.join(' ');
            item = data.find(d => d.line === line && d.size === size && d.type === type && d.deposit === deposit);
        } else {
            item = data.find(d => d.size === sizeVal && d.type === type && d.deposit === deposit);
        }

        if (!item) return;
        currentItem = item;

        const color = getCatColor(currentCategory);
        const displayName = currentCategory === '저가형' ? item.line : currentCategory;

        // 제품 스펙 표시
        showSpec(item);

        // 결과 헤더
        const header = document.getElementById('resultHeader');
        let depositHtml = '';
        if (deposit > 0) {
            depositHtml = `<div class="deposit-display ${color}">선납금 ${fmt(deposit)}원</div>`;
        } else {
            depositHtml = `<div class="deposit-display ${color}">선납금 없음</div>`;
        }

        header.innerHTML = `
            <div class="result-product-name">${displayName} ${item.size}</div>
            <div class="result-spec">${item.typeDetail}</div>
            ${depositHtml}
        `;

        // 가격 카드
        const grid = document.getElementById('priceGrid');
        const periods = Object.keys(item.prices).sort((a, b) => parseInt(a) - parseInt(b));
        grid.innerHTML = '';

        periods.forEach((period, idx) => {
            const p = item.prices[period];
            const isRecommended = period === '36';
            let periodLabel = '';
            if (period === '12') periodLabel = '단기';
            else if (period === '24') periodLabel = '최저총액';
            else if (period === '36') periodLabel = '추천';
            else if (period === '60') periodLabel = '최저월납';

            grid.innerHTML += `
                <div class="price-card color-${color} ${isRecommended ? 'recommended' : ''}">
                    <div class="price-period"><strong>${period}개월</strong>${periodLabel}</div>
                    <div class="price-monthly">
                        <div class="label">월 렌탈료</div>
                        <div class="amount">${fmt(p.monthly)}<span class="won">원</span></div>
                    </div>
                    <div class="price-total">
                        <div class="label">총 납입금액</div>
                        <div class="amount">${fmt(p.total)}원</div>
                    </div>
                </div>
            `;
        });

        document.getElementById('resultSection').classList.add('show');
        document.getElementById('emptyState').style.display = 'none';

        // 스크롤
        setTimeout(() => {
            document.getElementById('specSection').scrollIntoView({ behavior: 'smooth', block: 'start' });
        }, 100);
    }

    // 스펙 정보 표시
    function showSpec(item) {
        const specSection = document.getElementById('specSection');
        const specGrid = document.getElementById('specGrid');
        const giftBox = document.getElementById('giftBox');
        const giftItems = document.getElementById('giftItems');

        if (!item.spec) {
            specSection.style.display = 'none';
            return;
        }

        specGrid.innerHTML = `
            <div class="spec-item">
                <span class="spec-label">무게</span>
                <span class="spec-value">${item.spec.weight}</span>
            </div>
            <div class="spec-item">
                <span class="spec-label">크기</span>
                <span class="spec-value">${item.spec.dimension}</span>
            </div>
            <div class="spec-item">
                <span class="spec-label">VESA</span>
                <span class="spec-value">${item.spec.vesa}</span>
            </div>
            <div class="spec-item">
                <span class="spec-label">해상도</span>
                <span class="spec-value">${item.spec.resolution}</span>
            </div>
            ${item.spec.led ? `<div class="spec-item"><span class="spec-label">디스플레이</span><span class="spec-value">${item.spec.led}</span></div>` : ''}
        `;

        if (item.gift) {
            giftItems.textContent = item.gift;
            giftBox.style.display = 'flex';
        } else {
            giftBox.style.display = 'none';
        }

        specSection.style.display = 'block';
    }

    function hideResult() {
        document.getElementById('resultSection').classList.remove('show');
        document.getElementById('emptyState').style.display = 'block';
        document.getElementById('specSection').style.display = 'none';
        currentItem = null;
    }

    function resetFrom(level) {
        const levels = ['type', 'deposit'];
        const idx = levels.indexOf(level);
        for (let i = idx; i < levels.length; i++) {
            const sel = document.getElementById('sel' + levels[i].charAt(0).toUpperCase() + levels[i].slice(1));
            if (levels[i] === 'deposit') {
                document.getElementById('depositField').style.display = 'none';
            }
            if (sel) {
                sel.innerHTML = `<option value="">${getPlaceholder(levels[i])}</option>`;
                sel.disabled = true;
            }
        }
        hideResult();
    }

    function getPlaceholder(level) {
        const map = {
            'type': '화면 크기를 먼저 선택하세요',
            'deposit': '선납금 선택'
        };
        return map[level] || '';
    }

    // PWA 설치
    window.addEventListener('beforeinstallprompt', (e) => {
        e.preventDefault();
        deferredPrompt = e;
    });

    // 이미 설치된 경우 버튼 숨기기
    window.addEventListener('appinstalled', () => {
        document.getElementById('installBtn').classList.add('hide');
    });

    // standalone 모드로 실행 중이면 버튼 숨기기
    if (window.matchMedia('(display-mode: standalone)').matches || window.navigator.standalone) {
        document.addEventListener('DOMContentLoaded', () => {
            document.getElementById('installBtn').classList.add('hide');
        });
    }

    function installApp() {
        // Android/Desktop Chrome
        if (deferredPrompt) {
            deferredPrompt.prompt();
            deferredPrompt.userChoice.then((result) => {
                if (result.outcome === 'accepted') {
                    document.getElementById('installBtn').classList.add('hide');
                }
                deferredPrompt = null;
            });
        }
        // iOS Safari
        else if (/iPhone|iPad|iPod/.test(navigator.userAgent) && !window.navigator.standalone) {
            alert('홈 화면에 추가하려면:\n1. 하단의 공유 버튼(□↑)을 탭하세요\n2. "홈 화면에 추가"를 선택하세요');
        }
        // 기타 브라우저
        else {
            alert('브라우저 메뉴에서 "홈 화면에 추가" 또는 "앱 설치"를 선택하세요');
        }
    }

    // === 견적서 출력 탭 기능 ===
    function updateEstimateTab() {
        const noProduct = document.getElementById('estNoProduct');
        const form = document.getElementById('estForm');
        if (!currentItem) {
            noProduct.style.display = 'block';
            form.style.display = 'none';
            return;
        }
        noProduct.style.display = 'none';
        form.style.display = 'block';

        // 제품 요약 표시
        const displayName = currentCategory === '저가형' ? (currentItem.line + ' ' + currentItem.size) : (currentCategory + ' ' + currentItem.size);
        const summary = document.getElementById('estProductSummary');
        summary.innerHTML = `
            <div class="est-summary-title">${displayName}</div>
            <div class="est-summary-detail">${currentItem.typeDetail} | ${currentRentalType} | 선납금 ${fmt(currentItem.deposit)}원</div>
        `;

        // 기간 드롭다운
        const selPeriod = document.getElementById('estPeriod');
        const periods = Object.keys(currentItem.prices).sort((a,b)=>parseInt(a)-parseInt(b));
        selPeriod.innerHTML = '<option value="">기간 선택</option>';
        periods.forEach(p => {
            selPeriod.innerHTML += `<option value="${p}">${p}개월 (월 ${fmt(currentItem.prices[p].monthly)}원)</option>`;
        });

        // 오늘 날짜 기본값
        if (!document.getElementById('estDate').value) {
            document.getElementById('estDate').value = new Date().toISOString().slice(0,10);
        }
    }

    function buildPdfHTML(d) {
        const {company,representative,title,manager,phone,date,period,item,category,rentalType,footerBase64} = d;
        const priceInfo = item.prices[period];
        const sizeNum = item.size.replace(/[^0-9]/g,'');
        const displayCat = category === '저가형' ? (item.line || '저가형') : category;
        const modelNum = (PDF_MODELS[category] && PDF_MODELS[category][item.size]) || '';
        const isEdla = category === 'MX' || category === 'IX';
        const spec = PDF_SPECS[category] || PDF_SPECS['저가형'];
        const compText = item.gift || spec.comp;
        const dimText = item.spec.dimension + ', ' + item.spec.weight;
        const standType = item.type;
        const isWall = standType === '벽걸이';
        const selectedStand = PDF_STANDS[standType];
        const deposit = item.deposit;

        // 스탠드 옵션 행 생성
        function standRow(key, qty) {
            const s = PDF_STANDS[key];
            if (!s) return '';
            const salePrice = qty > 0 ? s.price : 0;
            return `<tr>
                <td rowspan="2" style="border:1px solid #aaa;padding:6px 8px;text-align:center;vertical-align:middle;font-size:11px;font-weight:600;">
                    ${s.name}<br><span style="font-size:10px;font-weight:400;">(모델명: ${s.model})</span>
                </td>
                <td style="border:1px solid #aaa;padding:6px 8px;font-size:10px;line-height:1.5;white-space:pre-line;">${s.spec}</td>
                <td rowspan="2" style="border:1px solid #aaa;padding:6px 8px;text-align:center;vertical-align:middle;">${qty}</td>
                <td rowspan="2" style="border:1px solid #aaa;padding:6px 8px;text-align:right;vertical-align:middle;">${fmt(s.price)}</td>
                <td rowspan="2" style="border:1px solid #aaa;padding:6px 8px;text-align:right;vertical-align:middle;">${qty > 0 ? fmt(salePrice) : '0'}</td>
            </tr>
            <tr>
                <td style="border:1px solid #aaa;padding:4px 8px;font-size:10px;">
                    <b>크기</b>&nbsp;&nbsp;${s.dim}
                </td>
            </tr>`;
        }

        // 옵션 테이블 (스탠드 2개 표시)
        let stand1Key, stand2Key, stand1Qty, stand2Qty;
        if (isWall) {
            stand1Key='선반'; stand1Qty=0; stand2Key='전동'; stand2Qty=0;
        } else if (standType === '전동') {
            stand1Key='선반'; stand1Qty=0; stand2Key='전동'; stand2Qty=1;
        } else if (standType === '원목') {
            stand1Key='선반'; stand1Qty=0; stand2Key='원목'; stand2Qty=1;
        } else {
            stand1Key='선반'; stand1Qty=0; stand2Key='전동'; stand2Qty=0;
        }
        const standTotal = stand2Qty > 0 ? PDF_STANDS[stand2Key].price : 0;

        return `<div style="width:794px;min-height:1123px;padding:40px 50px 30px;font-family:'Pretendard',-apple-system,'Malgun Gothic',sans-serif;background:#fff;color:#000;line-height:1.4;">
    <!-- 제목 -->
    <div style="text-align:center;margin-bottom:6px;">
        <div style="font-size:34px;font-weight:900;letter-spacing:6px;">견적서</div>
        <div style="font-size:11px;color:#555;margin-top:3px;">(무통장입금 거래, 세금계산서 발행)</div>
    </div>

    <!-- 수신자 -->
    <div style="margin-top:18px;margin-bottom:14px;">
        <div style="font-size:15px;font-weight:800;"><u>${esc(company)} ${esc(representative)} ${esc(title)} 귀중</u></div>
    </div>

    <!-- 정보 -->
    <div style="display:flex;justify-content:space-between;align-items:flex-start;">
        <div style="font-size:12px;">제목: 현대IT 전자칠판 구매 견적</div>
        <div style="text-align:right;font-size:12px;line-height:1.7;">
            <div>담당자 ${esc(manager)}</div>
            <div>연락처 ${esc(phone)}</div>
            <div>*견적일자 ${date}</div>
        </div>
    </div>
    <div style="text-align:right;font-size:10px;color:#666;margin-top:2px;">(단위 : 원)</div>

    <!-- 전자칠판 메인 테이블 -->
    <table style="width:100%;border-collapse:collapse;margin-top:4px;font-size:11px;">
        <thead>
            <tr style="background:#f0f0f0;">
                <th style="border:1px solid #aaa;padding:7px;width:130px;">전자칠판</th>
                <th style="border:1px solid #aaa;padding:7px;">주요 사양</th>
                <th style="border:1px solid #aaa;padding:7px;width:38px;">수량</th>
                <th style="border:1px solid #aaa;padding:7px;width:38px;">기간</th>
                <th style="border:1px solid #aaa;padding:7px;width:76px;">선납금</th>
                <th style="border:1px solid #aaa;padding:7px;width:66px;">렌탈료</th>
                <th style="border:1px solid #aaa;padding:7px;width:86px;">합계</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td rowspan="3" style="border:1px solid #aaa;padding:8px;text-align:center;vertical-align:middle;">
                    <div style="font-size:11px;">현대 IT 전자칠판 ${esc(displayCat)}</div>
                    <div style="font-size:30px;font-weight:900;margin:3px 0;">${sizeNum}"</div>
                    ${modelNum ? `<div style="font-size:10px;">${modelNum}</div>` : ''}
                    ${isEdla ? `<div style="font-size:10px;">EDLA인증</div>` : ''}
                </td>
                <td style="border:1px solid #aaa;padding:6px 8px;font-size:10px;line-height:1.6;">${esc(spec.main)}</td>
                <td rowspan="3" style="border:1px solid #aaa;padding:6px;text-align:center;vertical-align:middle;">1</td>
                <td rowspan="3" style="border:1px solid #aaa;padding:6px;text-align:center;vertical-align:middle;">${period}</td>
                <td rowspan="3" style="border:1px solid #aaa;padding:6px;text-align:right;vertical-align:middle;">${fmt(deposit)}</td>
                <td rowspan="3" style="border:1px solid #aaa;padding:6px;text-align:right;vertical-align:middle;">${fmt(priceInfo.monthly)}</td>
                <td rowspan="3" style="border:1px solid #aaa;padding:6px;text-align:right;vertical-align:middle;font-weight:700;">${fmt(priceInfo.total)}</td>
            </tr>
            <tr>
                <td style="border:1px solid #aaa;padding:5px 8px;font-size:10px;">
                    <b>구성품</b>&nbsp;&nbsp;${esc(compText)}
                </td>
            </tr>
            <tr>
                <td style="border:1px solid #aaa;padding:5px 8px;font-size:10px;">
                    <b>크기</b>&nbsp;&nbsp;${esc(dimText)}
                </td>
            </tr>
        </tbody>
    </table>
    <div style="text-align:right;font-weight:700;font-size:13px;margin:6px 0;">소계 <span style="display:inline-block;width:100px;text-align:right;">${fmt(priceInfo.total)}</span></div>

    <!-- 옵션 테이블 -->
    <table style="width:100%;border-collapse:collapse;margin-top:10px;font-size:11px;">
        <thead>
            <tr style="background:#f0f0f0;">
                <th style="border:1px solid #aaa;padding:7px;width:120px;">옵션</th>
                <th style="border:1px solid #aaa;padding:7px;">주요 사양</th>
                <th style="border:1px solid #aaa;padding:7px;width:44px;">수량</th>
                <th style="border:1px solid #aaa;padding:7px;width:76px;">단가</th>
                <th style="border:1px solid #aaa;padding:7px;width:86px;">판매가</th>
            </tr>
        </thead>
        <tbody>
            ${standRow(stand1Key, stand1Qty)}
            ${standRow(stand2Key, stand2Qty)}
        </tbody>
    </table>
    <div style="text-align:right;font-size:13px;margin:6px 0;">
        <div style="font-weight:700;">소계 <span style="display:inline-block;width:100px;text-align:right;">${fmt(standTotal)}</span></div>
        ${standTotal > 0 ? '<div style="font-weight:700;color:#c00;">무상제공</div>' : ''}
    </div>

    <!-- 합계 -->
    <div style="background:#1a237e;color:#fff;padding:10px 16px;display:flex;justify-content:space-between;font-weight:800;font-size:16px;margin-top:8px;">
        <span>합계(부가세 포함)</span>
        <span>&#8361;${fmt(priceInfo.total)}</span>
    </div>

    <!-- 하단 이미지 -->
    <div style="margin-top:12px;">
        <img src="${footerBase64}" style="width:100%;display:block;">
    </div>
</div>`;
    }


    async function generateQuotePDF() {
        const company = document.getElementById('estCompany').value.trim();
        const representative = document.getElementById('estRepresentative').value.trim();
        const title = document.getElementById('estTitle').value;
        const manager = document.getElementById('estManager').value.trim();
        const phone = document.getElementById('estPhone').value.trim();
        const date = document.getElementById('estDate').value;
        const period = document.getElementById('estPeriod').value;

        if (!company || !representative || !manager || !phone || !date || !period) {
            alert('모든 항목을 입력해주세요.');
            return;
        }
        if (!currentItem) {
            alert('렌탈 견적 탭에서 제품을 먼저 선택하세요.');
            return;
        }

        const btn = document.getElementById('estDownloadBtn');
        btn.disabled = true;
        btn.textContent = '생성 중...';

        try {
            const footerB64 = FOOTER_BASE64;
            const container = document.getElementById('pdfContainer');
            container.innerHTML = buildPdfHTML({
                company, representative, title, manager, phone, date, period,
                item: currentItem,
                footerBase64: footerB64,
                category: currentCategory,
                rentalType: currentRentalType
            });

            const canvas = await html2canvas(container.firstChild, {
                scale: 2,
                useCORS: true,
                allowTaint: true,
                logging: false,
                backgroundColor: '#ffffff'
            });

            const { jsPDF } = window.jspdf;
            const pdf = new jsPDF('p','mm','a4');
            const imgData = canvas.toDataURL('image/jpeg', 0.95);
            const pdfW = 210;
            const pdfH = (canvas.height * pdfW) / canvas.width;

            if (pdfH > 297) {
                pdf.addImage(imgData, 'JPEG', 0, 0, pdfW, 297);
            } else {
                pdf.addImage(imgData, 'JPEG', 0, 0, pdfW, pdfH);
            }

            const sizeShort = currentItem.size.replace(/[^0-9]/g,'');
            const filename = `${company}${representative}${title}_${sizeShort}${currentCategory}_${period}소유권이전_현대IT전자칠판견적서.pdf`;
            pdf.save(filename);

            container.innerHTML = '';
        } catch(e) {
            alert('PDF 생성 중 오류가 발생했습니다: ' + (e.message || e.name || String(e)));
        } finally {
            btn.disabled = false;
            btn.innerHTML = '<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M12 5v14M5 12l7 7 7-7"/></svg> PDF 견적서 다운로드';
        }
    }

    // 서비스 워커 등록
    if ('serviceWorker' in navigator) {
        navigator.serviceWorker.register('sw.js')
            .catch(() => {});
    }
    </script>
</body>
</html>
